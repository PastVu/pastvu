.commentHist(data-bind="with: repository[M!M]")
    | <script id="dothist" type="text/x-dot-template">
    ul.media-list
        | {{~it.hists :h:index}}
        li.media.hist
            a.pull-left(target="_blank", href="{{='/u/'+h.user.login}}")
                img.media-object(src="{{=h.user.avatar}}")
            .media-body
                .histHead
                    a.author(target="_blank", href="{{='/u/'+h.user.login}}") {{=h.user.disp}}
                    | {{?h.role}}
                    | &nbsp;
                    .role
                        | {{?h.role===5}}as moderator
                        | {{?h.roleregion}} of region&nbsp;
                        a(target="_blank", href="{{='/ps?f=r!' + h.roleregion.cid}}") {{=h.roleregion.title_en}}{{?}}
                        | {{??h.role>9}}as administrator{{?}}
                    | {{?}}
                    .dotDelimeter Â·
                    .histStamp {{=it.fDate(new Date(h.stamp))}}

                | {{?h.del}}
                .info.red
                    span.glyphicon.glyphicon-remove
                    |  Comment is removed
                .histText
                    | {{?h.del.origin || h.del.reason && h.del.reason.cid}}
                    div
                        .histCat Reason:
                        | {{?h.del.origin}} Parent comment removal&nbsp;
                        a(href="{{=it.link + '?hl=comment-' + h.del.origin}}") {{='#'+h.del.origin}}
                        | {{??!!h.del.reason.title}} {{=h.del.reason.title}}{{?}}
                    | {{?}}

                    | {{?h.del.reason && h.del.reason.desc}}
                    div
                        .histCat Description:
                        |  {{=h.del.reason.desc}}
                    | {{?}}

                | {{??h.restore}}
                .info.green
                    span.glyphicon.glyphicon-repeat
                    |  Comment is restored
                | {{??}}

                | {{?h.frag}}
                .info {{=h.frag}}
                | {{?}}

                | {{?h.txt}}
                | {{?h.txtd}}
                .info
                    span.glyphicon.glyphicon-pencil
                    |  Text is edited
                // ko with: hist_id[{{=h.id}}]
                .txtSwitch(data-bind="text: showdiff() ? 'Hide difference highlighting' : 'Show difference', click: function () {showdiff(!showdiff())}")
                .histText(data-bind="html: showdiff() ? txtd : txt")
                // /ko
                | {{??}}
                .histText {{=h.txt}}
                | {{?}}
                | {{?}}


                | {{?}}

        | {{~}}
    | </script>